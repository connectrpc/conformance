name: Unexpected Responses
mode: TEST_MODE_CLIENT
relevantCompressions:
  - COMPRESSION_IDENTITY
relevantCodecs:
  - CODEC_PROTO
testCases:
- request:
    testName: unmapped-http-status-code
    streamType: STREAM_TYPE_UNARY
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
      responseDefinition:
        rawResponse:
          statusCode: 418 # I'm a teapot
  expectedResponse:
    error:
      # unknown
      code: 2
- request:
    testName: nonexistent-http-status-code
    streamType: STREAM_TYPE_UNARY
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
      responseDefinition:
        rawResponse:
          statusCode: 800
  expectedResponse:
    error:
      # unknown
      code: 2
- request:
     testName: unexpected-content-type
     service: connectrpc.conformance.v1.ConformanceService
     method: Unary
     streamType: STREAM_TYPE_UNARY
     requestMessages:
     - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
       responseDefinition:
         rawResponse:
           headers:
             - name: Content-Type
               value: ["image/jpeg"]
  expectedResponse:
     error:
       # unknown
       code: 2
