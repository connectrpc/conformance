name: grpc web
relevantHttpVersions:
  - HTTP_VERSION_1
relevantCompressions:
  - COMPRESSION_IDENTITY
relevantCodecs:
  - CODEC_PROTO
relevantProtocols:
  - PROTOCOL_GRPC_WEB
mode: TEST_MODE_CLIENT
testCases:
# Unary Tests -----------------------------------------------------------------
- request:
    testName: unary success
    service: connectrpc.conformance.v1.ConformanceService
    method: Unary
    streamType: STREAM_TYPE_UNARY
    requestHeaders:
    - name: X-Conformance-Test
      value: ["Value1", "Value2"]
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
      responseDefinition:
        responseHeaders:
        - name: x-custom-header
          value: ["foo","bar","baz"]
        responseData: "dGVzdCByZXNwb25zZQ=="
        responseTrailers:
        - name: x-custom-trailer
          # TODO - grpc-web doesn't seem to be able to return multiple values for a single trailer name
          # Headers work fine, but trailers always return only the last value
          # value: ["bing", "quux"]
          value: ["bing"]
