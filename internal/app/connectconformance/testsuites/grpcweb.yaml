name: gRPC-web
relevantHttpVersions:
  - HTTP_VERSION_1
relevantCodecs:
  - CODEC_PROTO
relevantProtocols:
  - PROTOCOL_GRPC_WEB
mode: TEST_MODE_CLIENT
testCases:
# Unary Tests -----------------------------------------------------------------
- request:
    testName: server stream cancel after zero responses
    service: connectrpc.conformance.v1.ConformanceService
    method: ServerStream
    streamType: STREAM_TYPE_SERVER_STREAM
    cancel:
      afterNumResponses: 0
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.ServerStreamRequest
      responseDefinition:
        responseDelayMs: 100
        responseHeaders:
        - name: x-custom-header
          value: ["foo","bar","baz"]
        responseData:
          - "dGVzdCByZXNwb25zZQ=="
          - "dGVzdCByZXNwb25zZQ=="
        responseTrailers:
        - name: x-custom-trailer
          value: ["bing","quux"]
  # Override
  expectedResponse:
    error:
      code: 1
