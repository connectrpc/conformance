name: Unexpected
mode: TEST_MODE_CLIENT
relevantProtocols:
  - PROTOCOL_CONNECT
relevantCodecs:
  - CODEC_JSON
relevantCompressions:
  - COMPRESSION_IDENTITY
relevantHttpVersions:
  - HTTP_VERSION_1
testCases:
- request:
    testName: unmapped HTTP status code
    service: connectrpc.conformance.v1.ConformanceService
    method: Unary
    streamType: STREAM_TYPE_UNARY
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
      responseDefinition:
        rawResponse:
          statusCode: 418
  expectedResponse:
    error:
      # unknown
      code: 2
- request:
    testName: nonexistent HTTP status code
    service: connectrpc.conformance.v1.ConformanceService
    method: Unary
    streamType: STREAM_TYPE_UNARY
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
      responseDefinition:
        rawResponse:
          statusCode: 800
  expectedResponse:
    error:
      # unknown
      code: 2
# - request:
#     testName: unexpected content type 
#     service: connectrpc.conformance.v1.ConformanceService
#     method: Unary
#     streamType: STREAM_TYPE_UNARY
#     requestMessages:
#     - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
#       responseDefinition:
#         rawResponse:
#           statusCode: 200
#           unary:
#             text: "{\"payload\": {\"data\": \"dGVzdCByZXNwb25zZQ\"}}" 
#           headers:
#             - name: Content-Type
#               value: ["invalid"]
#   expectedResponse:
#     error:
#       # unknown
#       code: 2
- request:
    testName: unexpected content encoding 
    service: connectrpc.conformance.v1.ConformanceService
    method: Unary
    streamType: STREAM_TYPE_UNARY
    requestMessages:
    - "@type": type.googleapis.com/connectrpc.conformance.v1.UnaryRequest
      responseDefinition:
        rawResponse:
          statusCode: 200
          unary:
            text: "{\"payload\": {\"data\": \"dGVzdCByZXNwb25zZQ\"}}" 
          headers:
            - name: Content-Encoding
              value: ["invalid"]
  expectedResponse:
    error:
      # internal
      code: 13
